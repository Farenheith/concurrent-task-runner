"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const mocha_1 = require("mocha");
const test_utils_1 = require("./test-utils");
let cleanups;
mocha_1.beforeEach(() => {
    cleanups = [];
});
mocha_1.afterEach(() => {
    cleanups.forEach(x => x());
    cleanups = undefined;
});
function fakeStaticClass(cls) {
    if (cleanups === undefined) {
        throw new Error('Invalid context. Call it inside a beforeEach ou it');
    }
    const backup = test_utils_1.testUtils.prepare(cls, cls);
    cleanups.push(() => test_utils_1.testUtils.restoreBackup(backup, cls));
}
exports.fakeStaticClass = fakeStaticClass;
function getFakeInstance(cls, create) {
    const result = create ? create() : new cls();
    test_utils_1.testUtils.prepare(result, cls.prototype);
    return result;
}
exports.getFakeInstance = getFakeInstance;
//# sourceMappingURL=get-fake.js.map